# 함수 이동

```jsx
class Account {
	get overdraftCharge() {...}
}
```

↓

```jsx
class AccountType {
	get overdraftCharge() {...}
}
```

<aside>
⚠️ *"좋은 소프트웨어의 핵심은 ... 모듈성이다."*

</aside>

<aside>
⚠️ *"모듈성이란 프로그램의 어딘가를 수정하려 할 때 해당 기능과 깊이 관련된 작은 일부만 이해해도 가능하게 해주는 능력..."*

</aside>

- 모듈성을 높이는 방법
    1. 서로 연관된 요소들을 함께 묶는다.
    2. 요소 사이의 연결관계를 쉽게 찾을 수 있고 이해 할수 있도록 해야 한다.

    좋은 모듈화를 위해선 높은 프로그램 이해도가 요구된다.

    높은 프로그램 이해도를 반영하기 위해선 요소들을 잘 이동 시킬줄 알아야 한다.


모든 함수는 특정 컨텍스트 안에 존재하며 전역 함수도 있지만 대부분 특정 모듈에 속하며 OOP의 핵심 모듈화 컨텍스트는 클래스이다.

함수를 다른 함수에 중첩시켜도 또 다른 공통 컨텍스트를 만들게 된다.

함수 이동을 해야할 기준

- 모듈 A의 요소보다 모듈 B의 요소를 더 참조
- 호출자들의 현재 위치(호출자가 속한 모듈)나 다음 업데이트 때 바뀌리라 예상되는 위치에 따라서

후보+현재 컨텍스트에서 살펴봐야 할 것들

- 옮길 함수를 호출하는 함수들
- 옮길 함수가 호출하는 함수들
- 옮길 함수가 사용하는 데이터

만약 여러 관련된 함수들을 묶어야 한다면 [[여러 함수 클래스로 묶기]] OR [[클래스 추출]]

절차

1. 옮길 함수의 현재 컨텍스트에서 사용 중인 모든 프로그램 요소 조사,

    (함께 옮길 요소를 찾을 것)

    - 함께 옮길 함수 발견시 그 함수를 먼저 옮길 것
    - 하위 함수들의 호출자가 고수준 메서드 하나일 경우
        1. 하위 함수들을 고수준 함수에 인라인
        2. 고수준 함수 이동
        3. 이동된 위치에서 개별 함수로 다시 추출
2. 옮길 함수가 다형 메서드인지 확인
    - 같은 메서드가 슈퍼클래스 OR 서브 클래스에 선언 되어있는지 확인 할 것
3. 옮길 함수를 타깃 컨텍스트로 복사

    (원래 함수 = 소스함수, 복사로 새로 만든 함수 = 타깃 함수)

    (복사 이후 타깃 함수를 잘 다듬어 줄 것)

    - 함수 본문에서 소스 컨텍스트의 요소 사용시

        해당 요소를 매개변수로 넘김 OR 소스 컨텍스트 자체를 참조로 넘김

        (이는 넘길 요소가 많다면 참조로, 적다면 매개변수로 넘기면 된다.)

    - 함수 이동시 새 컨텍스트에 어울리는 새로운 이름으로 변경해줄 것(필요시에만)
4. 정적 분석
5. 소스 컨텍스트에서 타깃 함수를 참조할 방법을 찾아 적용
6. 테스트
7. 소스 함수를 인라인 할지 고려 할 것
    - 소스 함수를 호출하는 곳에서 타깃 함수를 직접 호출하는데 문제가 없을시

        중간 단계인 소스 함수를 제거 할 것
