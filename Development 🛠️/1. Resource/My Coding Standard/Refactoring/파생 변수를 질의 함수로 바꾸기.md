# 파생 변수를 질의 함수로 바꾸기

```jsx
get discountedTotal() => this._discountedTotal;//이 변수를 잘 보자
set discount(aNumber){
	const old = this._discount;
	this._discount = aNumber;
	this._discountedTotal += old - aNumber;
}
```

↓

```jsx
get discountedTotal() => this._baseTotal - this._discount;//여기선 없어졌다 이 파생 변수를 없앤 것이 이 페이지의 기법이다.
set discount(aNumber){this._discount = aNumber;}
```

이 기법은 가변데이터의 사용량을 줄이는 데 있다.

예외의 경우

1. 데이터 구조를 감싸며 그 데이터를 기초하여 계산한 결과를 속성으로 제공하는 객체
2. 데이터 구조를 받아 다른 데이터 구조로 변환해 반환하는 함수

소스 데이터가 가변이고 파생 데이터 구조의 수명을 관리 해야할 땐 객체를 사용하는 편이 훨씬 유리하다.

역으로 소스 데이터가 불변이거나 파생 데이터를 잠깐 쓰고 버릴 용도라면 어느 방식을 써도 상관 없다.

절차

1. 변수 값이 갱신되는 지점을 모두 찾는다. 필요 하면 [[변수 쪼개기]]를 활용해 각 갱신 지점에서 변수를 분리한다.
2. 해당 변수의 값을 계산해주는 함수를 만든다.
3. 해당 변수가 사용되는 모든 곳에 [[어서션을 추가]]하여 함수의 계산 결과가 변수의 값과 같은지 확인한다.

    필요하면 [[변수 캡슐화]]를 적용해 어셔션이 들어갈 장소를 마련해 준다.

4. 테스트
5. 변수를 읽는 코드를 모두 함수 호출로 대체한다.
6. 테스트
7. 변수를 선언하고 갱신하는 코드는 [[죽은 코드 제거]]로 없앤다.
