# 함수 추출

Android Studio기준

영역을 드래그하여 선택 후 ctrl + alt + M

절차

1. 함수를 새로 만들고 목적을 잘 드래내는 이름을 붙인다.(**'어떻게'**가 **아닌** **'무엇을'** 하는지가 드러나야 한다.)
    1. 대상 코드가 함수 호출문 하나처럼 **매우 간단해도** 함수로 뽑아서 목적이 더 잘 드러나는 **이름을 붙여 추출**!
    2. **이런 이름이 떠오르지 않는다면 추출 해선 안됨!**
    3. 처음부터 최선의 이름을 짓고 시작할 필요는 없다.(나중에 추출하다 생각날수도 있으니)
    4. 일단 **선추출 후별로시 다시 인라인** 하면 된다.
    5. 중첩 함수는 추출한 함수에 다시 중첩
    6. 원래 함수 밖으로 꺼내야 할 때가 오면 언제든 [[함수 이동]]을 적용하면 된다.
2. 추출할 코드를 원본 함수에서 **복 붙**
3. 추출한 코드중 원본 함수의 **지역변수를 참조** OR **추출한 함수의 유효범위를 벗어나는 변수**는 없는지 검사한다.

    (있다면 매개변수로 전달)

    1. 원본 함수의 중첩 함수로 전달시 이런 문제 발생 안함
    2. 일반적으로 사용되는 함수의 **지역 변수+ 매개변수는 보통 모두 인수로 전달**하는 것이다.
        1. 사용은 하지만 **값은 불변인 변수는 이렇게 쉽게 처리**한다.
    3. 추출한 함수서 사용되는 **변수가 밖에 선언시 안으로** 넣어준다.
    4. 추출한 함수에서 **가변 변수중 값으로 전달되는 것들**이 있다면 **주의**할 것,
        1. 만약 **이런 변수가 하나라면 질의 함수로 취급하여 그 결과를 해당 변수에 대입**
    5. 만약 값을 수정하는 지역 변수가 너무 많을시
        1. 추출 중단
        2. [[변수 분리]] OR [[임시 변수를 질의 함수로 변경]]과 같은 리펙토링을 적용
        3. 이후 다시 추출 시작
4. 변수를 다 처리 했다면 **컴파일**
    1. 만약 컴파일이 되는 언어로 개발시 **변수를 모두 처리한뒤 컴파일**을 시도 할 것

        (덜 처리된 변수를 찾기 용이하기 때문)

5. 원본 함수에서 추출한 코드 부분을 **새로 만든 함수를 호출하는 문장으로** 바꾼다.

    (즉, 추출한 함수로 일을 위임한다.)

6. 다른 코드에서 방금 추출한 것과 똑같거나 비슷한 코드가 없는지 살핀다. 있다면 방금 추출한 새 함수를 호출하도록 바꿀지 검토한다.

    ([[인라인 코드를 함수 호출로 변경]])

    (만약 이런 중복 검사 리펙토링시 검사 툴이 없다면 직접 찾아야 한다.)
